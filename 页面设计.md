# 页面设计文档：The Lost Codex (失落法典)

**版本：** v1.0
**设计风格：** Apple Design Language — 浅色主题，简洁留白，圆角卡片，毛玻璃层，流畅弹性动效
**目标平台：** iOS / Android（移动端优先）

---

## 全局设计规范

### 色板

| 色彩角色 | 色值 |
|---------|------|
| **背景 - 主** | 云白 #F5F5F7 |
| **背景 - 卡片** | 纯白 #FFFFFF |
| **背景 - 浮层** | #F2F2F7 (85% opacity) |
| **文字 - 主** | 墨黑 #1C1C1E |
| **文字 - 次** | #6C6C70 |
| **分割线** | #D1D1D6 |
| **红巨星 / 高危** | #FF3B30 |
| **结晶蓝 / 链接** | #007AFF |
| **殿堂金 / 成就** | #D4A017 |
| **成功绿** | #28A745 |
| **毛玻璃材质** | systemUltraThinMaterial |

**深色画布例外区域：**
- **星图区域**使用深蓝灰渐变背景 (#1B2838 → #2C3E50)，星星必须在深色底上才能发光
- **战斗页面**使用深色背景 (#0A0A0F)，保持战斗氛围的紧张感和沉浸感
- 这两个区域是功能性的深色画布，不是主题切换，进出时使用 crossfade 过渡 (0.3s)

### 导航架构

```
底部 Tab Bar（毛玻璃材质，4个Tab）
├── Tab 1: 主页 (Home)
├── Tab 2: 真理之书 (The Codex)
├── Tab 3: 灵魂锻造 (Soul Forge)
└── Tab 4: 我的 (Profile)
```

### 通用组件

| 组件 | 规格 |
|------|------|
| 圆角半径 | 卡片 16pt，按钮 12pt，弹窗 24pt |
| 毛玻璃 | systemUltraThinMaterial |
| 字体 | SF Pro Display (标题) / SF Pro Text (正文) / 等宽体 (数据) |
| 动效曲线 | spring(response: 0.5, dampingFraction: 0.8) |
| 触觉反馈 | 关键操作配合 Haptic Feedback (Impact / Notification) |
| 安全区域 | 严格遵守 Safe Area，底部 Tab Bar 高度 83pt (含 Home Indicator) |

---

## 一、Onboarding 流程（首次使用）

### 1.1 欢迎引导页 (Welcome)

**页面目的：** 建立产品第一印象，传递核心价值主张。

**布局结构：**
- 全屏沉浸式，无导航栏
- 横向翻页（PageViewController），共 3 页 + 1 页行动页

**页面内容：**

| 引导页 | 视觉 | 文案 |
|--------|------|------|
| 第 1 页 | 星空粒子动画，中央一颗红星脉动 | **"你的记忆正在消逝"** / 副标题："每天有 73% 的新词在 24 小时内被遗忘" |
| 第 2 页 | 红星渐变为白色恒星 | **"但算法不会忘记"** / 副标题："AI 精确计算每个单词的遗忘临界点" |
| 第 3 页 | 星空展开为完整星图 + 一个角色剪影 | **"在你定义的世界里，战胜遗忘"** / 副标题："沉浸式剧本 × 闪击战斗 × 间隔记忆" |
| 第 4 页 | 简洁的登录/注册界面 | 三种登录方式：Apple ID / 微信 / 手机号 |

**交互细节：**
- 底部有 PageControl 指示器（发光圆点样式，匹配星空主题）
- 支持左右滑动翻页，也可点击"下一步"按钮
- 第 4 页的登录按钮使用大号圆角按钮 (height: 56pt)，Apple Sign In 置顶
- 背景星空随翻页产生视差滚动效果 (Parallax)

**转场：** 登录成功后，星空坍缩汇聚到屏幕中心 → 过渡到词库选择页

---

### 1.2 词库选择页 (Word Pack Selection)

**页面目的：** 选择学习目标词库，确定学习范围。

**布局结构：**
```
┌──────────────────────────────┐
│  导航栏: "选择你的法典"         │
├──────────────────────────────┤
│                              │
│  顶部说明文字（轻量灰色）       │
│  "选择一本法典，开始你的征程"    │
│                              │
│  分类 Tab (横向滚动)           │
│  [中小学] [大学/考研] [出国留学] │
│                              │
│  ── 当前: 中小学 ──            │
│  ┌─────────┐  ┌─────────┐   │
│  │ 5年级    │  │ 6年级    │   │
│  │  图标    │  │  图标    │   │
│  │  300词  │  │  400词  │   │
│  └─────────┘  └─────────┘   │
│  ┌─────────┐  ┌─────────┐   │
│  │ 7年级    │  │ 8年级    │   │
│  │  图标    │  │  图标    │   │
│  │  600词  │  │  700词  │   │
│  └─────────┘  └─────────┘   │
│  ┌─────────┐  ┌─────────┐   │
│  │ 9年级    │  │ 10年级   │   │
│  │  图标    │  │  图标    │   │
│  │  500词  │  │  800词  │   │
│  └─────────┘  └─────────┘   │
│  ┌─────────┐  ┌─────────┐   │
│  │ 11年级   │  │ 12年级   │   │
│  │  图标    │  │  图标    │   │
│  │  900词  │  │  600词  │   │
│  └─────────┘  └─────────┘   │
│                              │
│  ── 切换到: 大学/考研 ──       │
│  CET-4 / CET-6 / 考研英语     │
│                              │
│  ── 切换到: 出国留学 ──        │
│  IELTS / TOEFL / GRE核心      │
│                              │
├──────────────────────────────┤
│  已选: 9年级 ✓  12年级 ✓      │
│  [ 确认选择 ] (大号主按钮)     │
└──────────────────────────────┘
```

**词库列表：**

| 分类 | 词库名称 | 词汇量 | 难度标签 | 说明 |
|------|---------|--------|---------|------|
| 中小学 | 5年级新学 | ~300 | ⭐ | 小学高年级基础词汇 |
| 中小学 | 6年级新学 | ~400 | ⭐ | 小升初衔接词汇 |
| 中小学 | 7年级新学 | ~600 | ⭐⭐ | 初一新增词汇 |
| 中小学 | 8年级新学 | ~700 | ⭐⭐ | 初二新增词汇 |
| 中小学 | 9年级新学 | ~500 | ⭐⭐ | 初三新增词汇 |
| 中小学 | 10年级新学 | ~800 | ⭐⭐⭐ | 高一新增词汇 |
| 中小学 | 11年级新学 | ~900 | ⭐⭐⭐ | 高二新增词汇 |
| 中小学 | 12年级新学 | ~600 | ⭐⭐⭐ | 高三新增词汇 |
| 大学/考研 | CET-4 | ~4500 | ⭐⭐⭐ | 大学英语四级 |
| 大学/考研 | CET-6 | ~5500 | ⭐⭐⭐⭐ | 大学英语六级 |
| 大学/考研 | 考研英语 | ~5000 | ⭐⭐⭐⭐ | 考研核心词汇 |
| 出国留学 | IELTS | ~3500 | ⭐⭐⭐⭐ | 雅思核心词汇 |
| 出国留学 | TOEFL | ~4000 | ⭐⭐⭐⭐ | 托福核心词汇 |
| 出国留学 | GRE核心 | ~3000 | ⭐⭐⭐⭐⭐ | GRE 高频核心词 |

**关键元素：**
- 词库按分类展示，顶部分类 Tab 横向滚动切换（中小学 / 大学考研 / 出国留学）
- 每个词库以卡片形式呈现（纯白卡片 #FFFFFF，圆角 16pt，轻投影 shadow-sm）
- 卡片包含：词库图标（书本风格）、名称、词汇量、难度标签（星级）
- 选中态：卡片边框发光 (结晶蓝 glow)，内部出现勾选标记
- 支持多选（用户可同时学习多个词库）
- 每个词库卡片底部有进度条预留位（首次为空）
- 底部固定栏显示已选词库摘要（"已选: 9年级 ✓ 12年级 ✓"）+ 确认按钮

**交互细节：**
- 分类 Tab 切换时，卡片区域使用横向滑入动画
- 卡片点击时有 scale 弹性动画 (0.95 → 1.0)
- 长按卡片可预览词库详情（词频分布、难度曲线）
- 年级词库之间有智能去重提示：如需备考中考/高考，系统提示"建议同时选择 7-9 年级覆盖中考范围"或"建议同时选择 10-12 年级覆盖高考新增范围"
- 确认后弹出每日目标设置浮层："每天学习多少个新词？" — 滑块选择 (5/10/15/20/30)

**转场：** 确认选择 → 世界观设定页（从底部弹起的全屏 Sheet）

---

### 1.3 世界观设定页 (World Building)

**页面目的：** 选择剧本风格，自定义主角，建立情感连接。

**布局结构：**
```
┌──────────────────────────────┐
│  导航栏: "创建你的世界"  [跳过] │
├──────────────────────────────┤
│                              │
│  ── 第一步：选择世界观 ──       │
│                              │
│  横向滑动卡片 (Carousel)：     │
│  ┌────────────────────┐      │
│  │                    │      │
│  │   [全屏场景插画]     │      │
│  │                    │      │
│  │   "赛博朋克侦探"     │      │
│  │   霓虹灯下的暗夜追踪  │      │
│  │                    │      │
│  └────────────────────┘      │
│         · ○ · ·              │
│                              │
│  ── 第二步：塑造主角 ──        │
│                              │
│  ┌────────────────────┐      │
│  │  [主角头像预览]       │      │
│  │   圆形，带光效边框    │      │
│  └────────────────────┘      │
│                              │
│  角色名称: [输入框]           │
│  性别: [男/女/其他] 分段控件    │
│  性格标签: [选择2-3个]         │
│    冷静 / 热血 / 智慧 /        │
│    幽默 / 神秘 / 善良          │
│                              │
├──────────────────────────────┤
│  [ 开启冒险 ] (大号主按钮)     │
└──────────────────────────────┘
```

**世界观选项（Carousel 卡片）：**

| 世界观 | 插画风格 | 氛围描述 |
|--------|---------|---------|
| MOBA 竞技场 | 暗色竞技场，光柱，英雄剪影 | "在召唤师峡谷，用词汇碾压对手" |
| 修仙飞升 | 云海仙山，飘逸仙人 | "一词一剑，斩破天道桎梏" |
| 赛博朋克侦探 | 霓虹雨夜，全息投影 | "在数据洪流中追踪真相" |
| 校园甜宠 | 樱花校园，温暖色调 | "每个单词都是一封情书" |
| ✨ 自定义世界观 | 渐变星云 + "?" 图标 | "输入你最爱的 IP 或题材" |

**自定义世界观交互：**
- Carousel 最后一张卡片为 "✨ 自定义世界观"，选中后展开输入区域
- **输入框：** 大号文本框，placeholder 示例轮播："哈利波特"→"塞尔达传说"→"名侦探柯南"→"三体"→"海贼王"
- **智能适配：** 用户输入后，LLM 自动识别 IP/题材，生成匹配的世界观设定、语言风格和角色模板
- **预览确认：** 输入后延迟 1 秒，下方显示 AI 生成的世界观预览卡片（插画风格描述 + 氛围文案 + 示例剧情片段），用户确认后生效
- **兜底策略：** 若输入内容无法识别（如乱码），提示"请输入一个故事/游戏/动漫名称或题材描述"并给出推荐列表

**交互细节：**
- Carousel 使用 3D 透视效果，当前卡片居中放大，两侧缩小并降低透明度
- 选择世界观后，头像预览区域会动态切换风格（赛博风→霓虹光圈，修仙→仙气缭绕）
- 性格标签使用 Chip 组件，选中后变为主题色填充
- 角色名称输入框支持随机生成按钮（骰子图标）
- "跳过" 使用系统默认设定（赛博朋克 + 随机角色）

**转场：** "开启冒险" → 全屏粒子特效（世界观风格粒子汇聚成门/传送门） → 主页

---

## 二、主页 (Home)

**页面目的：** 每日核心入口，展示角色状态、今日任务概览、快速开始学习。

**布局结构：**
```
┌──────────────────────────────────┐
│  状态栏 (系统)                     │
├──────────────────────────────────┤
│                                  │
│  顶部区域 (Hero Section)          │
│  ┌────────────────────────────┐  │
│  │                            │  │
│  │     [角色全身立绘]           │  │
│  │     身穿当前装备              │  │
│  │     背景：对应世界观场景       │  │
│  │                            │  │
│  │  角色名   Lv.23             │  │
│  │  ━━━━━━━━━━━━ 经验条        │  │
│  │  ◆ 灵魂碎片: 2,350          │  │
│  └────────────────────────────┘  │
│                                  │
│  今日概览 (Today's Brief)         │
│  ┌────────────────────────────┐  │
│  │  🔴 25 个高危词汇等待复习     │  │
│  │  ⭐ 10 个新词准备解锁         │  │
│  │  📖 连续学习: 14 天           │  │
│  │  ⚔ 今日进度: 0/5 轮完成      │  │
│  └────────────────────────────┘  │
│                                  │
│  ┌────────────────────────────┐  │
│  │                            │  │
│  │   [ ⚔ 消灭下一波 (5词) ]    │  │
│  │    (核心 CTA 按钮)           │  │
│  │    脉动光效，吸引点击         │  │
│  │                            │  │
│  └────────────────────────────┘  │
│                                  │
│  快捷入口 (Quick Access)          │
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐  │
│  │星图 │ │生词 │ │铁匠 │ │历史 │  │
│  │    │ │ 本 │ │ 铺 │ │副本 │  │
│  └────┘ └────┘ └────┘ └────┘  │
│                                  │
│  今日成就 (Today's Achievements)  │
│  ┌────────────────────────────┐  │
│  │  横向滚动成就卡片             │  │
│  │  "完美格挡 x5" "秒杀连击 x3"  │  │
│  └────────────────────────────┘  │
│                                  │
├──────────────────────────────────┤
│  [主页] [真理之书] [锻造] [我的]   │
│           Tab Bar                │
└──────────────────────────────────┘
```

**关键元素详述：**

**Hero Section（角色展示区）：**
- 初始占据屏幕上半部分约 **28%** 高度（约 200pt），确保今日概览和 CTA 按钮首屏可见
- 用户向下滚动时，Hero Section 使用 **collapse 效果**渐变缩小到导航栏高度（仅保留角色头像缩略图 + 等级 + 碎片数），释放更多内容空间
- 角色立绘使用高精度 2D 插画，支持待机动画（呼吸/飘动）
- 主武器实时渲染在角色身上（当前穿戴的主要装备）
- 背景使用对应世界观的场景（带微弱粒子效果，如赛博风的数据流/修仙风的浮云）
- 点击角色可进入角色详情/装备页

**今日概览卡片：**
- 毛玻璃背景卡片
- 红色高危词汇数字使用脉动动画（呼吸效果），制造紧迫感
- 新词数量使用结晶蓝
- 连续学习天数使用殿堂金
- 卡片可向下展开显示更多数据（今日已学/总掌握量/预测完成日期）

**核心 CTA 按钮 "消灭下一波"：**
- 大号胶囊按钮 (width: 80%, height: 60pt)
- 按钮文案动态显示当前波次："消灭下一波 (5词)" → "第2波 (5词)" → ...
- 背景渐变：红色 (#FF3B30) → 橙色 (#FF9500)
- 持续脉动光晕动画，边缘有微弱的发光粒子
- 当日所有红星清零后变为 "继续探索"（蓝色渐变），文案和颜色平滑过渡
- 按下时有明显的 Haptic Impact (heavy)

**分波机制说明：**
- 每次战斗固定处理 **5 颗红星**（含复习词 + 少量新词混合）
- 若今日共 25 颗红星，拆分为 5 波，每波独立副本 + 独立战斗 + 独立结算
- 用户可随时退出，下次继续从下一波开始
- 今日进度条显示 "已完成 X/N 波"，给予阶段性成就感

**快捷入口区：**
- 4 个圆角方形图标按钮，横向等距排列
- 各入口图标使用 SF Symbols + 主题色描边
- 点击有 scale 弹性反馈

**交互细节：**
- 页面支持下拉刷新（刷新今日数据/同步服务器）
- 整体可纵向滚动
- 角色区域随滚动有视差效果（角色上移速度慢于内容）
- 若用户超过 24 小时未学习，红星数字增加抖动 + 红色警告条出现在顶部

---

## 三、副本生成页 (Dungeon Loading)

**页面目的：** 过渡页，在等待 AIGC 生成内容时保持沉浸感。

**布局结构：**
```
┌──────────────────────────────┐
│                              │
│         全屏沉浸式            │
│         深色背景              │
│                              │
│    ┌──────────────────┐      │
│    │ 世界观对应的       │      │
│    │ 传送门/加载动画    │      │
│    └──────────────────┘      │
│                              │
│    "正在生成今日副本..."       │
│    赛博夜之城 · 第 42 章      │
│                              │
│    ── 本波植入词汇 (5词) ──   │
│    ┌──────────────────┐      │
│    │ Current  Strategy │      │
│    │ Obstacle  Force   │      │
│    │ Resolve            │      │
│    │ (词汇逐个淡入)     │      │
│    └──────────────────┘      │
│                              │
│    ━━━━━━━━━░░░░  65%        │
│    进度条（模拟/真实混合）     │
│                              │
│    💡小贴士:                  │
│    "Current 既可表示'水流'     │
│     也可表示'当前的'"          │
│                              │
└──────────────────────────────┘
```

**关键元素：**
- 全屏无导航栏，沉浸等待（无返回按钮，防止打断生成）
- 传送门动画：根据世界观风格不同
  - 赛博朋克：数据矩阵瀑布 + 全息圆环旋转
  - 修仙：仙门裂缝 + 金光溢出
  - MOBA：传送阵法 + 能量聚合
  - 校园：翻开的书本 + 页面飞散

**等待交互三阶段设计：**

AIGC 生成通常需要 3-8 秒，等待页将这段时间拆分为三个阶段，每个阶段有独立的交互目标：

**阶段一：词汇预热 (0-3秒)**
```
┌──────────────────────────────┐
│                              │
│    [传送门动画 - 缓慢开启]     │
│                              │
│    "正在扫描遗忘临界点..."     │
│                              │
│    ┌──────────────────┐      │
│    │                  │      │
│    │   C U R R E N T  │      │
│    │   /ˈkʌrənt/      │      │
│    │   ① n. 水流       │      │
│    │   ② adj. 当前的   │      │
│    │   ③ n. 电流       │      │
│    │                  │      │
│    │   记忆状态: Lv.2   │      │
│    │   上次复习: 2天前   │      │
│    │                  │      │
│    └──────────────────┘      │
│    (卡片自动翻转到下一个词)    │
│                              │
│    ━━━━░░░░░░░░  20%         │
│                              │
└──────────────────────────────┘
```
- 本波 5 个词以卡片形式**逐张展示**，每张停留 0.6 秒后自动翻转到下一张
- 每张卡片展示：单词 + 音标 + 多个释义 + 当前记忆等级
- 卡片使用 3D 翻转动画（Flip），营造"检阅部队"的仪式感
- 用户可点击卡片发音，主动预习

**阶段二：剧情预告 (3-5秒)**
```
┌──────────────────────────────┐
│                              │
│    [传送门动画 - 半开启]       │
│                              │
│    赛博夜之城 · 第 42 章      │
│    "霓虹审判"                 │
│                              │
│    ┌──────────────────┐      │
│    │ [氛围插图：暗巷/雨夜]│      │
│    │ 半透明，逐渐清晰     │      │
│    └──────────────────┘      │
│                              │
│    "The body doctor's hideout │
│     lies beneath the sewers  │
│     of District Seven..."    │
│    (英文剧情开头1-2句，逐字出现)│
│                              │
│    ━━━━━━━━░░░░  65%         │
│                              │
└──────────────────────────────┘
```
- 章节标题 + 副标题（AI 生成的章节名）出现
- 氛围插图从模糊逐渐变清晰（高斯模糊从 20px → 0px）
- 剧情第一段以打字机效果出现，制造悬念
- 提前"钩住"用户，从等待焦虑转为期待

**阶段三：战前准备 (5-8秒，可选/真实等待)**
```
┌──────────────────────────────┐
│                              │
│    [传送门动画 - 即将全开]     │
│                              │
│    ── 本波作战情报 ──          │
│                              │
│    ┌──────────────────┐      │
│    │ 🔴 Current   Lv.2│      │
│    │   上次: 犹豫 1.2s  │      │
│    │   建议: 注意多义词  │      │
│    ├──────────────────┤      │
│    │ 🔴 Strategy Lv.2 │      │
│    │   上次: 完美 0.6s  │      │
│    │   建议: 保持状态    │      │
│    ├──────────────────┤      │
│    │ ★ Resolve   Lv.0 │      │
│    │   新词首秀          │      │
│    │   建议: 留意剧情中   │      │
│    └──────────────────┘      │
│                              │
│    ━━━━━━━━━━━░  92%         │
│                              │
│    💡 Current 既可表示         │
│       '水流' 也可表示 '当前的'  │
│                              │
└──────────────────────────────┘
```
- 展示每个词的"作战情报"：上次反应速度、历史弱点、AI 建议
- 新词标注"新词首秀"，提醒用户在剧情中重点关注
- 底部轮播知识小贴士（与本波词汇相关的易混淆/多义/搭配知识）
- 此阶段在后台生成完成后仍可停留 1-2 秒，让用户读完情报

**进度条策略：**
- 前 60%：匀速推进（对应阶段一 + 阶段二，约 5 秒）
- 60-90%：减速推进（对应阶段三，等待真实完成）
- 90-100%：后台确认完成后快速填满 + 完成音效
- 永远不会卡在某个百分比不动——即使后台未完成，也会以极慢速度前进

**完成动效：**
- 进度条满 → Haptic Notification (success)
- 传送门全开 / 书本完全翻开
- 0.3 秒停顿（让用户感知到"完成"）
- 页面无缝过渡到剧本阅读页（传送门内容就是剧情第一页）

**转场：** 进度完成 → 传送门展开/书本翻开 → 内容直接拼接到剧本阅读页首屏（无跳转感）

---

## 四、剧本阅读页 (Narrative / Story Page)

**页面目的：** 核心沉浸式英文阅读体验，在全英文故事中自然接触目标词汇。

**语言规则：**
- **剧情正文：全英文。** LLM 生成的故事内容完全使用英文书写，目标词汇在英文语境中自然出现
- **UI 元素：中文。** 导航栏章节名、选项标签、菜单、按钮等界面元素保持中文
- **词义浮层：中英对照。** 点击高亮单词弹出的释义浮层使用中文解释

**布局结构：**
```
┌──────────────────────────────┐
│  [←] 赛博夜之城·第42章  [≡]  │
│       (半透明导航栏)          │
├──────────────────────────────┤
│                              │
│  ┌────────────────────┐      │
│  │  [场景插画/氛围图]    │      │
│  │  宽度铺满，高度 200pt │      │
│  │  带底部渐变遮罩       │      │
│  └────────────────────┘      │
│                              │
│  剧情文本区 (ScrollView)      │
│  ┌────────────────────┐      │
│  │                    │      │
│  │ Neon lights shattered│      │
│  │ into a thousand     │      │
│  │ glimmers in the rain.│      │
│  │ You walked deeper   │      │
│  │ into the alley, a   │      │
│  │ rusted iron gate    │      │
│  │ standing before you.│      │
│  │ The body doctor's   │      │
│  │ hideout lay beyond  │      │
│  │ it, but you needed  │      │
│  │ a clever「Strategy」│      │
│  │ to handle the danger│      │
│  │ ahead...            │      │
│  │                    │      │
│  │ You noticed a fierce│      │
│  │「Current」surging   │      │
│  │ from the drainage   │      │
│  │ pipe beside the     │      │
│  │ gate...             │      │
│  │                    │      │
│  └────────────────────┘      │
│                              │
│  ── 抉择时刻 ──              │
│  ┌────────────────────┐      │
│  │  ✦ 选项 A (智慧型)   │      │
│  │  "Analyze calmly and │      │
│  │   find a way around  │      │
│  │   the current."      │      │
│  └────────────────────┘      │
│  ┌────────────────────┐      │
│  │  ✦ 选项 B (力量型)   │      │
│  │  "Charge through     │      │
│  │   with brute force." │      │
│  └────────────────────┘      │
│                              │
├──────────────────────────────┤
│  Tab Bar (隐藏/半透明)        │
└──────────────────────────────┘
```

**关键元素详述：**

**目标词汇高亮 (Highlighted Words)：**
- 目标单词使用特殊样式：加粗 + 主题色下划线 + 微弱发光效果
- 颜色按等级区分：
  - Lv.0 (新词)：金色高亮，附带 ✦ 标记
  - Lv.1 (烙印)：橙色高亮
  - Lv.2 (高危)：红色高亮
  - Lv.3-4 (加固)：蓝色高亮
- 点击高亮单词 → 弹出词义浮层 (Popover)：
  ```
  ┌─────────────────────┐
  │ Strategy  /ˈstrætədʒi/│
  │ 🔊                   │
  │ n. 策略；战略          │
  │ 例: marketing strategy│
  │ ───────────────       │
  │ [加入生词本] [已掌握]   │
  └─────────────────────┘
  ```
- 浮层使用毛玻璃材质，圆角 16pt
- 点击发音图标播放真人发音
- "加入生词本" 操作后浮层自动收起并显示 toast 提示

**剧情文本排版：**
- 字体：SF Pro Text 17pt，行间距 1.6，字间距 0.3pt
- 段落间距 24pt
- 文本区域左右 padding 24pt
- 对话文本使用不同缩进 + 引号样式
- 支持字体大小调节（右上角菜单）
- 全英文正文，LLM 根据用户词库等级控制生词密度和句子复杂度
- 目标词汇以「」书名号标记 + 高亮样式，与普通英文文本区分

**分支选择 (Narrative Branching)：**
- 选项卡片使用毛玻璃背景 + 左侧彩色竖线标识
  - 智慧型：蓝色竖线 + 脑图标
  - 力量型：红色竖线 + 拳头图标
- 点击选项 → 卡片高亮 + scale 动画 → 1秒后展开后续剧情
- 后续剧情以打字机效果逐字出现（增强叙事感）
- 选择后选项不可更改（灰化另一个选项）

**右上角菜单 [≡]：**
- 章节目录
- 字体大小调节
- 背景音乐开关
- 本章词汇列表
- 退出副本（二次确认）

**交互细节：**
- 阅读过程中 Tab Bar 自动隐藏，上滑时显示
- 剧情文本支持纵向滚动
- 到达章节末尾时自动出现 "进入战斗" 过渡
- 支持截图分享（自动生成精美卡片，含剧情片段 + 词汇统计）

**转场：** 剧情到达战斗触发点 → 屏幕震动 + 红色闪烁 → "警报！敌人来袭！" → 滑动过渡到战斗页

---

## 五、战斗页 (Blitz Combat)

**页面目的：** 通过高强度交互验证词汇记忆，提供即时反馈。

### 5.1 格挡模式 (Parry - 英→中)

**布局结构：**
```
┌──────────────────────────────┐
│  HP条 [████████░░]  连击: x5  │
├──────────────────────────────┤
│                              │
│        [敌人立绘/头像]         │
│        攻击动画               │
│            ↓                 │
│     ╔═══════════════╗        │
│     ║               ║        │
│     ║   STRATEGY    ║        │
│     ║   (攻击携带词)  ║        │
│     ║               ║        │
│     ╚═══════════════╝        │
│            ↓                 │
│    ╭──────────────────╮      │
│    │   倒计时光环       │      │
│    │   (1秒环形进度)    │      │
│    ╰──────────────────╯      │
│                              │
│  ┌────┐  ┌────┐  ┌────┐    │
│  │策略 │  │战略 │  │流动 │    │
│  │ ✓  │  │    │  │    │    │
│  └────┘  └────┘  └────┘    │
│                              │
│    [玩家角色立绘 + 盾牌]       │
│                              │
├──────────────────────────────┤
│  (Tab Bar 隐藏)               │
└──────────────────────────────┘
```

**关键元素：**
- **敌人区域 (上方)：** 敌人立绘 + 攻击动画（刀光/魔法弹飞出）
- **单词展示区 (中央)：**
  - 英文单词以大号加粗显示 (36pt, SF Pro Display Bold)
  - 伴随攻击粒子效果从上方飞来
  - 周围有环形倒计时光圈（1秒内从绿→黄→红）
- **选项区 (中下方)：**
  - 3 个中文释义按钮，横向排列
  - 按钮使用毛玻璃卡片样式
  - 正确答案随机分布在 3 个位置
- **玩家区域 (下方)：** 玩家角色持盾待命姿态

**反馈动效：**
| 结果 | 视觉效果 | 触觉 | 音效 |
|------|---------|------|------|
| 完美格挡 (<0.8s) | 金色盾牌爆裂特效 + "PERFECT" 大字 + 连击+1 | Haptic: Impact Heavy | 金属碰撞音 |
| 普通格挡 (0.8-2.0s) | 蓝色盾牌格挡 + "GOOD" | Haptic: Impact Medium | 格挡音 |
| 格挡失败 (>2.0s / 错误) | 红色裂痕 + HP 减少动画 + 屏幕震动 | Haptic: Notification Error | 受伤音 |

### 5.2 吟唱模式 (Chant - 中→英)

**布局结构：**
```
┌──────────────────────────────┐
│  HP条 [████████░░]  连击: x5  │
├──────────────────────────────┤
│                              │
│    [玩家角色 蓄力姿态]          │
│                              │
│     ╔═══════════════╗        │
│     ║    策  略      ║        │
│     ║   (提示中文)    ║        │
│     ╚═══════════════╝        │
│                              │
│    ╭──────────────────╮      │
│    │ 漂浮气泡区域       │      │
│    │                  │      │
│    │  ○ Current       │      │
│    │       ○ Strategy │      │
│    │  ○ Obstacle      │      │
│    │       ○ Force    │      │
│    │                  │      │
│    ╰──────────────────╯      │
│                              │
│        [敌人立绘]             │
│                              │
├──────────────────────────────┤
│  (Tab Bar 隐藏)               │
└──────────────────────────────┘
```

**关键元素：**
- 中文提示词显示在角色上方
- 英文单词作为"气泡"在屏幕中漂浮移动（缓慢飘动，增加选择难度）
- 气泡使用半透明圆形容器，字体 18pt
- 4-6 个干扰项 + 1 个正确答案
- 气泡可点击，点击正确气泡 → 角色释放技能攻击敌人

**气泡运动：**
- V1：气泡在初始位置缓慢漂移（线性轨迹，速度 20pt/s），不做碰撞检测
- V2（进阶）：困难模式下解锁布朗运动 + 碰撞物理，增加选择难度
- 气泡大小与单词长度成正比
- 气泡之间保持最小间距 (16pt)，初始布局时通过力导向算法排布避免重叠

### 5.3 决斗模式 (Duel - Boss 终结技)

**布局结构：**
```
┌──────────────────────────────┐
│                              │
│       全屏高能警告             │
│    ╔═══════════════════╗     │
│    ║  ⚡ DUEL TIME ⚡   ║     │
│    ╚═══════════════════╝     │
│                              │
│    Boss 巨幅特写 + 压迫感      │
│                              │
│     「 CURRENT 」             │
│                              │
│  ┌──────────┐ ┌──────────┐  │
│  │           │ │           │  │
│  │   水 流   │ │   当前的   │  │
│  │           │ │           │  │
│  └──────────┘ └──────────┘  │
│                              │
│    ━━━━━━━━━━━ (极速倒计时)   │
│    ← 1.0 秒 →               │
│                              │
└──────────────────────────────┘
```

**关键元素：**
- 全屏事件，暂停所有其他 UI
- 背景变暗 + 红色脉动光效
- 单词居中大号显示
- 只有 2 个选项（二选一），按钮占据屏幕下半部分，极大化点击区域
- 倒计时条从中间向两端消失（视觉压迫感）

**判定时间：1.0 秒。** 该时间经过以下推算确定：移动端触控响应延迟约 50-100ms，用户从视觉认知到手指动作约需 300-400ms，留给决策的有效窗口约 500-600ms，足够紧张但不至于退化为随机猜测。

**通用战斗 UI 元素：**
- **HP 条：** 顶部横向条，绿→黄→红渐变，带数字显示
- **连击计数器：** 右上角，连续正确后数字递增 + 火焰效果
- **背景音乐：** 快节奏战斗 BGM，Boss 阶段变调加速

**装备数值对战斗的影响：**
- **ATK 加成：** 攻击力提供额外判定时间加成（如 ATK 50 → 判定窗口 +0.1s），在 HP 条右侧显示小号 ⚔ 图标 + 数值
- **DEF 加成：** 防御力降低答错/超时的扣血量（如 DEF 50 → 伤害减免 20%），在 HP 条右侧显示小号 🛡 图标 + 数值
- **判定时间上限：** ATK 加成最大 +0.3s，且**与战斗难度不叠乘**。最终判定时间 = min(基础时间 × 难度系数, 基础时间 + ATK 加成)，确保任何组合下判定窗口不超过 1.5s（格挡/吟唱）或 1.3s（决斗），保持记忆验证的有效性
- **装备数值入口：** 战斗开始前，屏幕顶部短暂显示"战力概览"横条（ATK / DEF / 总战力），1.5 秒后自动收起
- **装备不足提示：** 若装备等级低于敌人等级 2 级以上，战斗开始前弹出 toast 警告："敌人实力强大，建议先强化装备"（可忽略继续战斗）

**敌人成长机制：**
- 敌人等级 = 用户累计完成波次 ÷ 10（每 10 波敌人升 1 级）
- 敌人等级影响：
  - **攻击频率：** 基础间隔 3s → 每级 -0.1s（下限 1.5s）
  - **攻击伤害：** 基础伤害 10 → 每级 +2
  - **Boss 血量：** 基础 3 回合 → 每 5 级 +1 回合
  - **进阶机制（Lv.10+）：** 解锁连续攻击（2 词连击）、双词同屏、限时多选等
- 敌人外观随等级进化：普通小怪 → 精英怪（发光描边）→ Boss（独立立绘 + 专属技能名）

---

## 六、战斗结算页 (Battle Result / Reward)

**页面目的：** 展示战果，给予正向反馈，形成激励闭环。

**布局结构：**
```
┌──────────────────────────────┐
│                              │
│        ✦ VICTORY ✦           │
│    (或 DEFEAT - 仍有奖励)     │
│                              │
│    [角色胜利姿态 立绘]          │
│    带粒子/光效               │
│                              │
│  ── 战斗统计 ──               │
│  ┌────────────────────────┐  │
│  │ 本波红星    5 → 0  ✓    │  │
│  │ 今日进度    第 3/5 波    │  │
│  │ 完美格挡    4 次        │  │
│  │ 最快反应    0.31 秒     │  │
│  │ 新词解锁    1 个        │  │
│  │ 正确率      92%        │  │
│  └────────────────────────┘  │
│                              │
│  ── 词汇状态变化 ──           │
│  ┌────────────────────────┐  │
│  │ Strategy  Lv.2 → Lv.3 ↑│  │
│  │ Current   Lv.2 → Lv.3 ↑│  │
│  │ Obstacle  Lv.0 → Lv.1 ★│  │
│  │ Force     Lv.2 → Lv.2 ↓│  │
│  └────────────────────────┘  │
│                              │
│  ── 奖励 ──                  │
│  ┌────────────────────────┐  │
│  │ 💎 灵魂碎片 +5            │  │
│  │ ⚔ 解锁装备: 幻影短刀      │  │
│  └────────────────────────┘  │
│                              │
│  [下一波]  [分享战绩]  [返回]  │
│                              │
└──────────────────────────────┘
```

**关键元素：**

**胜利/失败画面：**
- 胜利：角色胜利姿态 + 金色粒子雨 + 背景光柱
- 失败：角色半跪 + 暗色调（但仍给予部分奖励，避免负面情绪）
- 文字动画：逐字弹出，配合音效

**战斗统计区：**
- 卡片式布局，每行一个统计项
- 数字使用计数器动画（从 0 滚动到最终值）
- 关键数据（完美格挡次数/最快反应）配特殊标记

**词汇状态变化区：**
- 列表展示每个参战词汇的等级变化
- 升级用绿色箭头 ↑，降级用红色箭头 ↓
- 新词标注 ★ 星号
- 点击任意词汇可跳转到"单词编年史"

**奖励区：**
- 灵魂碎片获得量 = 本波消除的红星数（固定 5）
- 若触发装备解锁，使用宝箱开启动画
- 奖励卡片有光效流转边框

**底部三按钮：**
- **"下一波"：** 主按钮（橙色渐变），直接进入下一波副本生成，无需返回主页。若已是最后一波则隐藏此按钮
- **"分享战绩"：** 生成精美战绩卡片（包含角色形象 + 核心数据 + 产品水印），支持分享到微信/微博/保存到相册
- **"返回"：** 次要按钮（文字链样式），返回主页，下次从下一波继续

**转场：**
- "下一波" → 直接进入副本生成页（连贯体验）
- "返回" → 主页，星图中本波对应的红星→白星变化动画

---

## 七、真理之书 - 星图页 (The Codex - Constellation View)

**页面目的：** 将词库可视化为星空，一览全局掌握状态，驱动学习动力。

**布局结构：**
```
┌──────────────────────────────┐
│  真理之书        [筛选] [搜索] │
├──────────────────────────────┤
│                              │
│  顶部统计条 (Summary Bar)     │
│  ┌────────────────────────┐  │
│  │ 全部    迷雾   高危  稳定  │  │
│  │ 4500   2100   25   1800 │  │
│  │              殿堂        │  │
│  │              575        │  │
│  └────────────────────────┘  │
│                              │
│  星图主视图 (Constellation)    │
│  ┌────────────────────────┐  │
│  │                        │  │
│  │  初始视野（屏幕可见区域）  │  │
│  │  ┌──────────────────┐  │  │
│  │  │  🔴    🔴   🔴    │  │  │
│  │  │     🔴    🔴      │  │  │
│  │  │  ·    ·    ·      │  │  │
│  │  │     ·    ·        │  │  │
│  │  └──────────────────┘  │  │
│  │                        │  │
│  │  ← 向左平移可见 →       │  │
│  │  ☆  ★  ✦  ☆  ★  ✦    │  │
│  │  (已完成的词分布在外围)  │  │
│  │                        │  │
│  └────────────────────────┘  │
│                              │
│  支持双指缩放 / 拖动平移       │
│                              │
│  底部图例 (Legend)            │
│  🔴 高危  🟠 新烙印  ☆ 稳定   │
│  ★ 结晶  ✦ 殿堂              │
│                              │
├──────────────────────────────┤
│  [主页] [真理之书] [锻造] [我的]│
└──────────────────────────────┘
```

**星星视觉规格：**

| 等级 | 星星样式 | 大小 | 动画 |
|------|---------|------|------|
| Lv.0 迷雾 | 灰色微弱光点 | 3pt | 无（默认不在星图主视图中渲染，仅在全局鸟瞰时显示为背景雾气） |
| Lv.1 烙印 | 橙黄色暖光点 | 6pt | 缓慢明灭（刚烙印，尚未高危） |
| Lv.2 高危 | 红色脉动光球 | 8pt | 持续脉动 (呼吸频率)，紧迫感最强 |
| Lv.3 加固 | 蓝白色稳定星 | 6pt | 微弱闪烁 |
| Lv.4 结晶 | 明亮白星 | 8pt | 稳定发光 |
| Lv.5 殿堂 | 金色超新星 | 10pt | 缓慢旋转 + 光芒放射 |

**星图空间布局（视野焦点模型）：**

星图采用**同心环扩散布局**，以屏幕中心为焦点，按学习紧迫度从内向外排列：

```
                    ┌──────── 视野外（需平移） ────────┐
                    │   ✦ ✦ ✦ ✦ ✦ ✦ ✦ ✦ ✦ ✦ ✦       │
                    │ ✦                           ✦   │
                    │ ✦  ┌── 初始视野（屏幕） ──┐  ✦   │
                    │ ★  │  🟠 🟠         🟠    │  ★   │
                    │ ☆  │    🔴  🔴  🔴        │  ☆   │
                    │ ★  │  🟠  🔴  🔴  🟠     │  ★   │
                    │ ☆  │    🔴  🔴  🔴        │  ☆   │
                    │ ★  │  🟠 🟠         🟠    │  ★   │
                    │ ☆  └──────────────────────┘  ☆   │
                    │ ★                           ★   │
                    │   ☆ ★ ☆ ★ ☆ ★ ☆ ★ ☆ ★ ☆       │
                    └─────────────────────────────────┘
```

| 环层 | 距中心 | 内容 | 打开时是否可见 |
|------|--------|------|--------------|
| **核心区** | 0-20% | 🔴 Lv.2 高危词（今日必须复习，遗忘临界点） | ✅ 初始视野中心 |
| **烙印区** | 20-40% | 🟠 Lv.1 新烙印词（今天刚学，尚未高危） | ✅ 初始视野内 |
| **稳定区** | 40-65% | ☆★ Lv.3-4 加固/结晶词 | ❌ 需向外平移 |
| **殿堂区** | 65-85% | ✦ Lv.5 殿堂词 | ❌ 需向外平移 |
| **迷雾区** | 85-100% | Lv.0 未解锁词（不渲染为独立星星，以灰色雾气/星云效果暗示） | ❌ 需向外平移，仅全局鸟瞰时可见 |

**布局规则：**
- 页面打开时，相机自动对焦到核心区中心，**用户第一眼看到的就是所有红星 (Lv.2)**
- 红星在核心区内按语义聚类（相近含义的词靠近）
- 红星外围是橙黄色的 Lv.1 烙印词，形成"今日新学"的暖色光环
- 从核心区向外平移，依次看到烙印词 → 加固词 → 殿堂词 → 迷雾星云
- Lv.0 未解锁词**不渲染为单独光点**（4500 词的灰点会严重干扰视野），改用边缘雾气/星云效果暗示未探索区域
- 殿堂词形成"金色环带"——视觉上像银河的明亮光带
- 整体形成从"紧迫红色中心"→"暖橙烙印"→"冷蓝稳定"→"金色殿堂"→"灰色迷雾"的渐变叙事

**平移与缩放交互：**
- 支持双指缩放：缩小可看全局鸟瞰，放大可看单词文本
- 支持单指拖动平移浏览各环层
- 平移到外围殿堂区时，底部出现 toast 提示："你已掌握 575 个词汇"
- 缩放到最大时，每颗星旁显示单词文本标签

**视野外提示：**
- 屏幕边缘有微弱方向箭头提示（"← 575 颗殿堂星"），引导用户探索外围
- 快速双击屏幕可在"核心区视野"和"全局鸟瞰"之间切换

**筛选功能 [筛选]：**
- 底部弹出 Sheet，支持按等级/主题/词库/最近复习日期筛选
- 筛选后非匹配星星降低透明度到 10%
- 筛选特定等级时，相机自动平移到对应环层

**搜索功能 [搜索]：**
- 顶部展开搜索栏
- 输入单词后，目标星星放大并闪烁定位光圈
- 相机自动平移对焦到目标星星（可能需要移动到外围环层）

**点击交互：**
- 点击任意星星 → 短暂放大 + 显示悬浮标签（单词 + 等级 + 下次复习）
- 双击/长按 → 进入该单词的"编年史"页面

**大词库渲染优化：**
- 采用 LOD (Level of Detail) 分级渲染。缩小到全局视图时，只渲染红星和金星的色块热力图；放大到局部时才渲染每颗星的细节
- **渲染方案分级：**
  - **首选（iOS 原生）：** SpriteKit 粒子系统，利用 GPU 加速，性能优秀
  - **跨平台方案：** Skia (Flutter) / Canvas + WebGL (React Native)，通过自定义 2D 粒子引擎实现
  - **降级方案：** 当星星总数 > 2000 时，Lv.0 迷雾区改为静态纹理贴图，仅渲染 Lv.1+ 的活跃星星（通常 < 500 颗），大幅降低渲染压力

---

## 八、单词编年史页 (Word Chronicle)

**页面目的：** 展示单个词汇的完整"人生经历"，增强情感连接。

**布局结构：**
```
┌──────────────────────────────┐
│  [←]   Word Chronicle        │
├──────────────────────────────┤
│                              │
│  ┌────────────────────────┐  │
│  │   S T R A T E G Y      │  │
│  │   /ˈstrætədʒi/  🔊     │  │
│  │   n. 策略；战略；行动纲领 │  │
│  │                        │  │
│  │   状态: Lv.3 加固 ☆     │  │
│  │   下次复习: 3 天后       │  │
│  │   总接触次数: 27 次      │  │
│  └────────────────────────┘  │
│                              │
│  ── 记忆强度曲线 ──           │
│  ┌────────────────────────┐  │
│  │   📈 遗忘曲线图表        │  │
│  │   (折线图：横轴时间，     │  │
│  │    纵轴记忆强度 0-100%)  │  │
│  │   标注每次复习节点        │  │
│  └────────────────────────┘  │
│                              │
│  ── 初次相遇 ──              │
│  ┌────────────────────────┐  │
│  │   📖 修仙飞升·第三章     │  │
│  │   2024.03.15            │  │
│  │   "...The elder pondered │  │
│  │    for a moment, then    │  │
│  │    adopted a new         │  │
│  │   「Strategy」to face..." │  │
│  │   [查看完整章节]          │  │
│  └────────────────────────┘  │
│                              │
│  ── 战斗荣耀 ──              │
│  ┌────────────────────────┐  │
│  │  ⚔ 格挡此词  18 次       │  │
│  │  ⭐ 完美格挡  12 次       │  │
│  │  ❌ 失败      3 次        │  │
│  │  ⚡ 最快反应  0.31 秒     │  │
│  └────────────────────────┘  │
│                              │
│  ── 时间线 ──                │
│  ┌────────────────────────┐  │
│  │  ● 03.15 初次解锁 Lv.0  │  │
│  │  │                      │  │
│  │  ● 03.16 首次复习 Lv.1  │  │
│  │  │                      │  │
│  │  ● 03.18 战斗升级 Lv.2  │  │
│  │  │                      │  │
│  │  ● 03.25 巩固复习 Lv.3  │  │
│  │  │  (当前)               │  │
│  │  ○ 03.28 预计下次复习    │  │
│  └────────────────────────┘  │
│                              │
├──────────────────────────────┤
│  Tab Bar                     │
└──────────────────────────────┘
```

**关键元素：**

**头部信息卡片：**
- 单词大号显示 (32pt, Bold)，下方为音标和释义
- 发音按钮支持美音/英音切换
- 状态 badge 使用对应等级颜色
- 卡片背景：浅色毛玻璃 (#F2F2F7, 85% opacity) + 对应等级色的淡彩光晕

**记忆强度曲线：**
- 折线图，使用 Swift Charts / 自定义绘制
- 横轴：时间线（日期），纵轴：记忆强度 (0-100%)
- 曲线颜色：从红(低)渐变到绿(高)
- 标注每次复习事件（圆点标记）
- 可横向滑动查看历史

**初次相遇区域：**
- 显示该词汇第一次在剧本中出现时的上下文片段（英文原文）
- 附带当时的章节名和日期
- 有一个微缩场景插图/氛围色块
- 可点击查看完整章节回顾
- **存储策略：** 仅存储触发段落的文本片段（前后各 2 句，约 200-300 字符/词），不存完整章节。完整章节回顾需要重新请求 LLM 基于摘要重建（或提示"完整章节已过期"）

**战斗荣耀区域：**
- 统计数据使用图标 + 数字 + 进度条组合
- 完美格挡率可以计算并展示百分比
- 若有特殊成就（如"连续10次完美格挡"），显示成就徽章

**时间线 (Timeline)：**
- 垂直时间轴，圆点节点 + 连接线
- 已发生的事件使用实心圆点 + 实线
- 未来预测使用空心圆点 + 虚线
- 每个节点可展开查看详情

---

## 九、灵魂锻造页 (Soul Forge)

**页面目的：** 装备升级与角色外观自定义，提供长线成长目标。

**布局结构：**
```
┌──────────────────────────────┐
│  灵魂锻造           💎 2,350  │
├──────────────────────────────┤
│                              │
│  ┌────────────────────────┐  │
│  │                        │  │
│  │    [角色 3D/2D 立绘]    │  │
│  │    可旋转查看            │  │
│  │    装备实时渲染           │  │
│  │                        │  │
│  └────────────────────────┘  │
│                              │
│  装备槽位 (Equipment Slots)   │
│  ┌────┐  ┌────┐  ┌────┐    │
│  │ 武器│  │ 护甲│  │ 饰品│    │
│  │ ⚔  │  │ 🛡  │  │ 💍  │    │
│  └────┘  └────┘  └────┘    │
│                              │
│  ── 角色战力 ──               │
│  ┌────────────────────────┐  │
│  │  ⚔ ATK 128   🛡 DEF 96  │  │
│  │  总战力: 224              │  │
│  │  当前敌人等级: Lv.8       │  │
│  │  推荐战力: ≥200  ✅       │  │
│  └────────────────────────┘  │
│                              │
│  ── 当前选中装备 ──           │
│  ┌────────────────────────┐  │
│  │  ⚔ 幻影短刀  [Lv.3]    │  │
│  │  ATK +32  DEF +8        │  │
│  │  ━━━━━━━━░░ 进化进度    │  │
│  │  下一级需要: 50 碎片     │  │
│  │  下一级: ATK +38 DEF +10│  │
│  │                        │  │
│  │  [升级] [更换] [预览]    │  │
│  └────────────────────────┘  │
│                              │
│  ── 仓库 ──                  │
│  ┌────────────────────────┐  │
│  │  网格展示所有已解锁装备   │  │
│  │  ┌──┐ ┌──┐ ┌──┐ ┌──┐  │  │
│  │  │🗡│ │🛡│ │💍│ │⚔│  │  │
│  │  └──┘ └──┘ └──┘ └──┘  │  │
│  │  ┌──┐ ┌──┐ ┌──┐ ┌──┐  │  │
│  │  │🔮│ │🔒│ │🔒│ │🔒│  │  │
│  │  └──┘ └──┘ └──┘ └──┘  │  │
│  └────────────────────────┘  │
│                              │
├──────────────────────────────┤
│  [主页] [真理之书] [锻造] [我的]│
└──────────────────────────────┘
```

**关键元素：**

**角色预览区：**
- 角色立绘占屏幕上方 35%
- 支持左右滑动旋转角色（查看装备不同角度）
- **渲染方案（V1）：** 采用分层合成——角色底图 + 主武器图层 + 护甲图层 + 饰品图层，按 z-index 叠加。V1 仅实现默认世界观的装备美术，其他世界观使用通用样式 + 色调映射
- 装备变更时有穿戴动画
- 背景使用对应世界观铁匠铺场景（赛博→改装车间，修仙→炼器阁）

**装备槽位：**
- **3 个槽位**（武器/护甲/饰品），V1 保持精简，验证用户对装备系统的兴趣后再考虑扩展
- 槽位使用圆角方形图标，横向等距排列
- 已装备：显示装备缩略图 + 等级标记
- 空槽位：灰色虚线框 + "+" 号
- 点击槽位 → 弹出该槽位可用装备列表

**角色战力面板：**
- 装备槽位下方，毛玻璃卡片，横向展示 ⚔ ATK 总值和 🛡 DEF 总值
- 总战力 = ATK + DEF，使用大号加粗数字
- 显示当前敌人等级和推荐战力：
  - 战力 ≥ 推荐值：绿色 ✅
  - 战力略低（80-100%）：黄色 ⚠ "建议强化"
  - 战力不足（<80%）：红色 ❗ "急需强化"，卡片边框红色脉动
- 点击面板展开详细属性分解（各槽位贡献占比条形图）

**装备详情卡片：**
- 显示装备名称、等级、**ATK / DEF 属性值**、进化进度条
- 属性值使用对应颜色：ATK 红色，DEF 蓝色
- 升级预览：显示"下一级"属性值，用绿色 ↑ 标注提升量
- "升级" 按钮：消耗灵魂碎片，带铸造火花动画，升级后属性数字跳动递增
- "更换" 按钮：切换到仓库列表，更换时显示属性对比（旧 vs 新，绿色增/红色减）
- "预览" 按钮：在角色身上预览效果

**仓库区域：**
- 网格布局 (4列)，装备以图标形式展示
- 每个装备图标右下角显示等级标记，左下角显示品质色条
- 未解锁装备显示为锁定状态（暗色 + 🔒）
- 长按装备显示详情浮层（名称/等级/ATK/DEF/解锁条件）
- 装备品质用边框颜色区分：灰(普通)/绿(优秀)/蓝(稀有)/紫(史诗)/金(传说)
- 品质影响属性成长系数：普通 x1.0 / 优秀 x1.2 / 稀有 x1.5 / 史诗 x2.0 / 传说 x3.0

**风格适配：**
- 同一槽位的装备外观自动适配世界观风格
- 如"头部装备"：修仙→发冠，赛博→护目镜，MOBA→头盔，校园→发饰
- 切换世界观时装备外观平滑过渡

---

## 十、生词本页 (Vocabulary Book)

**页面目的：** 传统词汇管理入口，列表形式查看和管理所有标记词汇。

**布局结构：**
```
┌──────────────────────────────┐
│  [←] 生词本       [排序] [+]  │
├──────────────────────────────┤
│                              │
│  分段控件 (Segmented Control) │
│  [全部|高危|加固|结晶|殿堂]    │
│                              │
│  搜索栏 (可折叠)              │
│  ┌────────────────────────┐  │
│  │ 🔍 搜索单词...          │  │
│  └────────────────────────┘  │
│                              │
│  词汇列表 (List)              │
│  ┌────────────────────────┐  │
│  │ 🔴 Strategy            │  │
│  │    n. 策略  下次: 明天   │  │
│  ├────────────────────────┤  │
│  │ 🔴 Current             │  │
│  │    n./adj. 水流;当前的   │  │
│  │    下次: 明天            │  │
│  ├────────────────────────┤  │
│  │ ☆ Obstacle             │  │
│  │    n. 障碍  下次: 3天后  │  │
│  ├────────────────────────┤  │
│  │ ✦ Magnificent          │  │
│  │    adj. 壮丽的  殿堂级   │  │
│  ├────────────────────────┤  │
│  │        ...              │  │
│  └────────────────────────┘  │
│                              │
├──────────────────────────────┤
│  Tab Bar                     │
└──────────────────────────────┘
```

**关键元素：**
- 分段控件按等级筛选，每段显示对应数量 badge
- 列表每行显示：等级图标 + 单词 + 简要释义 + 下次复习时间
- 左滑操作：标记为已掌握 / 重置等级 / 删除
- 右滑操作：立即复习（跳转到单独战斗）
- 排序选项：按字母 / 按等级 / 按下次复习时间 / 按添加时间
- "+" 按钮：手动添加自定义单词

**交互：**
- 点击任意单词 → 进入单词编年史
- 列表支持批量操作模式（长按进入，多选后批量操作）
- 下拉刷新同步数据

---

## 十一、个人中心页 (Profile)

**页面目的：** 用户信息管理、学习数据统计、系统设置入口。

**布局结构：**
```
┌──────────────────────────────┐
│  我的                [⚙设置]  │
├──────────────────────────────┤
│                              │
│  用户信息卡片                  │
│  ┌────────────────────────┐  │
│  │  [头像]  用户名          │  │
│  │         Lv.23           │  │
│  │         连续学习 14 天    │  │
│  │         加入 128 天      │  │
│  └────────────────────────┘  │
│                              │
│  ── 学习概览 ──               │
│  ┌──────┐ ┌──────┐ ┌──────┐│
│  │ 1,825 │ │  575 │ │ 92% ││
│  │ 已学词 │ │殿堂词│ │正确率││
│  └──────┘ └──────┘ └──────┘│
│                              │
│  ── 学习日历 ──               │
│  ┌────────────────────────┐  │
│  │  热力图日历              │  │
│  │  (GitHub Contribution    │  │
│  │   风格，显示每日学习量)    │  │
│  └────────────────────────┘  │
│                              │
│  ── 功能列表 ──               │
│  ┌────────────────────────┐  │
│  │  📚 词库管理     →       │  │
│  ├────────────────────────┤  │
│  │  🌍 世界观切换    →       │  │
│  ├────────────────────────┤  │
│  │  📖 历史副本      →       │  │
│  ├────────────────────────┤  │
│  │  🏆 成就系统      →       │  │
│  ├────────────────────────┤  │
│  │  🏅 荣誉殿堂      →       │  │
│  ├────────────────────────┤  │
│  │  📊 详细统计      →       │  │
│  ├────────────────────────┤  │
│  │  👥 排行榜        →       │  │
│  └────────────────────────┘  │
│                              │
├──────────────────────────────┤
│  [主页] [真理之书] [锻造] [我的]│
└──────────────────────────────┘
```

**关键元素：**

**用户信息卡片：**
- 大号圆形头像 (80pt)，边框颜色对应等级
- 等级/连续天数/加入天数并排显示
- 点击头像可更换头像（本地相册/预设头像）

**学习概览：**
- 三个数据指标横向排列，使用大号数字 + 小号标签
- 数字进入视图时有计数器动画

**学习日历：**
- 类似 GitHub 贡献图的热力图
- 颜色深浅表示当日学习量
- 横向可滚动查看历史月份
- 点击某天可查看当日详细学习记录

**功能列表：**
- 标准 iOS 设置列表样式
- 每行带图标 + 标题 + 右箭头
- 部分行可显示 badge（如成就系统有新成就未查看）

---

## 十二、设置页 (Settings)

**页面目的：** 应用配置与偏好管理。

**布局结构：**
```
┌──────────────────────────────┐
│  [←] 设置                     │
├──────────────────────────────┤
│                              │
│  ── 学习设置 ──               │
│  ┌────────────────────────┐  │
│  │  每日新词数量   [滑块 20] │  │
│  ├────────────────────────┤  │
│  │  每日复习上限   [滑块 50] │  │
│  ├────────────────────────┤  │
│  │  复习提醒      [开关 ON] │  │
│  ├────────────────────────┤  │
│  │  提醒时间      [20:00]  │  │
│  └────────────────────────┘  │
│                              │
│  ── 战斗设置 ──               │
│  ┌────────────────────────┐  │
│  │  战斗难度    [简单/标准/困难]│ │
│  ├────────────────────────┤  │
│  │  音效       [开关 ON]    │  │
│  ├────────────────────────┤  │
│  │  触觉反馈    [开关 ON]   │  │
│  ├────────────────────────┤  │
│  │  背景音乐    [开关 ON]   │  │
│  └────────────────────────┘  │
│                              │
│  ── 显示设置 ──               │
│  ┌────────────────────────┐  │
│  │  阅读字体大小  [滑块]     │  │
│  ├────────────────────────┤  │
│  │  发音偏好    [美音/英音]  │  │
│  └────────────────────────┘  │
│                              │
│  ── 账户 ──                  │
│  ┌────────────────────────┐  │
│  │  数据同步                │  │
│  ├────────────────────────┤  │
│  │  导出学习数据             │  │
│  ├────────────────────────┤  │
│  │  清除缓存                │  │
│  ├────────────────────────┤  │
│  │  关于我们                │  │
│  ├────────────────────────┤  │
│  │  退出登录     (红色文字)  │  │
│  └────────────────────────┘  │
│                              │
└──────────────────────────────┘
```

**设计说明：**
- 标准 iOS Settings 列表风格
- 滑块、开关、分段控件使用系统原生组件
- 战斗难度影响：简单(判定时间x1.5) / 标准(原始设定) / 困难(判定时间x0.7)
- 数据同步支持 iCloud / 自定义服务器

---

## 十三、成就系统页 (Achievements)

**页面目的：** 展示里程碑成就，提供长期目标激励。

**布局结构：**
```
┌──────────────────────────────┐
│  [←] 成就殿堂      已解锁 23/50│
├──────────────────────────────┤
│                              │
│  ── 传说成就 ──               │
│  ┌────────────────────────┐  │
│  │  🏆 "永恒之星"           │  │
│  │  将100个单词送入殿堂       │  │
│  │  ━━━━━━━░░░ 57/100      │  │
│  ├────────────────────────┤  │
│  │  🏆 "闪电之手"           │  │
│  │  达成50次完美格挡          │  │
│  │  ━━━━━━━━━━ 50/50  ✓    │  │
│  └────────────────────────┘  │
│                              │
│  ── 日常成就 ──               │
│  ┌────────────────────────┐  │
│  │  📅 "不灭之火"           │  │
│  │  连续学习30天             │  │
│  │  ━━━━━━░░░░ 14/30       │  │
│  ├────────────────────────┤  │
│  │  ...                    │  │
│  └────────────────────────┘  │
│                              │
│  ── 隐藏成就 ──               │
│  ┌────────────────────────┐  │
│  │  🔒 ???                 │  │
│  │  "在最意想不到的地方..."   │  │
│  └────────────────────────┘  │
│                              │
└──────────────────────────────┘
```

**关键元素：**
- 成就分为传说/日常/隐藏三类
- 已完成成就显示金色边框 + ✓ 标记
- 未完成显示进度条
- 隐藏成就以 ??? 显示，完成后才揭晓
- 完成成就时全屏弹出成就解锁动画（金色光效 + 徽章展示）

---

## 十四、荣誉殿堂页 (Hall of Fame)

**页面目的：** 展示殿堂词汇总览 + 里程碑纪念卡牌收藏，作为长线成就目标。

**设计理念：** 不为每个殿堂词单独生成卡牌（4500 词 = 4500 张卡牌会丧失稀缺感且成本过高），而是**仅在关键里程碑节点生成精美纪念卡牌**，每张都是重大事件。殿堂词本身在星图外环以金色超新星形式展示。

**布局结构：**
```
┌──────────────────────────────┐
│  [←] 荣誉殿堂                │
├──────────────────────────────┤
│                              │
│  殿堂总览                     │
│  ┌────────────────────────┐  │
│  │  ✦ 575 / 4500 词汇已永久│  │
│  │  掌握                    │  │
│  │  ━━━━━━░░░░░░  12.8%    │  │
│  │  累计学习 87 天           │  │
│  └────────────────────────┘  │
│                              │
│  ── 里程碑卡牌 (3/10) ──      │
│                              │
│  ┌──────────────────────┐    │
│  │  ╔════════════════╗  │    │
│  │  ║  ★ MILESTONE   ║  │    │
│  │  ║     #3          ║  │    │
│  │  ║                 ║  │    │
│  │  ║  [AI 生成精美    ║  │    │
│  │  ║   世界观插画]    ║  │    │
│  │  ║                 ║  │    │
│  │  ║  第 50 个殿堂词  ║  │    │
│  │  ║  "RESILIENCE"  ║  │    │
│  │  ║  韧性            ║  │    │
│  │  ║                 ║  │    │
│  │  ║  2024.06.15     ║  │    │
│  │  ║  学习第 45 天    ║  │    │
│  │  ╚════════════════╝  │    │
│  └──────────────────────┘    │
│        · ○ ·  (横滑翻页)     │
│                              │
│  ── 下一个里程碑 ──           │
│  ┌────────────────────────┐  │
│  │  🔒 第 100 个殿堂词      │  │
│  │  ━━━━━━━░░░ 57/100      │  │
│  │  还差 43 个词达成          │  │
│  └────────────────────────┘  │
│                              │
│  ── 殿堂词列表 ──             │
│  ┌────────────────────────┐  │
│  │ Strategy   ✦  2024.03  │  │
│  │ Current    ✦  2024.03  │  │
│  │ Obstacle   ✦  2024.04  │  │
│  │ ...查看全部 575 个 →     │  │
│  └────────────────────────┘  │
│                              │
└──────────────────────────────┘
```

**里程碑卡牌体系：**

| 里程碑 | 触发条件 | 卡牌主题 | 稀有度 |
|--------|---------|---------|--------|
| #1 | 第 1 个殿堂词 | "初心 · First Light" | 普通 (白边) |
| #2 | 第 10 个殿堂词 | "启程 · Departure" | 普通 (白边) |
| #3 | 第 50 个殿堂词 | "觉醒 · Awakening" | 稀有 (蓝边) |
| #4 | 第 100 个殿堂词 | "百炼 · Centurion" | 稀有 (蓝边) |
| #5 | 第 200 个殿堂词 | "不灭 · Undying" | 史诗 (紫边) |
| #6 | 第 500 个殿堂词 | "传说 · Legend" | 史诗 (紫边) |
| #7 | 第 1000 个殿堂词 | "千词碑 · Millennium" | 传说 (金边) |
| #8 | 第 2000 个殿堂词 | "无尽 · Infinite" | 传说 (金边) |
| #9 | 第 3000 个殿堂词 | "超越 · Transcend" | 传说 (金边) |
| #10 | 全部词汇通关 | "永恒 · Eternity" | 传说 (金边 + 全息) |

**关键元素：**

**殿堂总览区：**
- 顶部卡片展示殿堂词总数 / 词库总数，环形进度条
- 累计学习天数、总战斗次数等概览数据
- 进度条使用殿堂金渐变

**里程碑卡牌展示区：**
- 横向 Carousel 展示已解锁的里程碑卡牌，每张占屏幕 80% 宽度
- 每张卡牌内容：
  - **正面：** 里程碑编号 + AI 生成的世界观插画 + 触发该里程碑的单词 + 中文释义 + 达成日期 + 累计学习天数
  - **背面（点击翻转）：** 回顾数据面板——达成时的总战斗次数、完美格挡率、最爱的世界观、剧情章节数等
- 未解锁的卡牌显示为暗色锁定状态，展示解锁条件和当前进度
- 卡牌品质边框：白/蓝/紫/金，传说级卡牌有持续流光动画

**下一里程碑预告：**
- 显示距离下一个里程碑还差多少词
- 进度条 + 预估达成日期（基于近期学习速率计算）
- 当进度 ≥ 90% 时，卡片边框开始发光脉动，制造期待感

**殿堂词列表：**
- 底部简洁列表，展示所有已进入殿堂的词汇（单词 + ✦ 标记 + 达成日期）
- 默认显示最近 5 个，点击"查看全部"进入完整列表页
- 点击任意词汇可跳转到"单词编年史"

**卡牌解锁仪式（全屏弹窗）：**
- 触发里程碑时，战斗结算后弹出全屏解锁动画
- 动画序列：光芒汇聚 → 卡牌从光中浮现 → 翻转展示正面 → 彩色粒子爆发
- 专属音效（每个稀有度等级音效不同）
- Haptic Feedback: 连续三次 Impact (heavy)
- 底部按钮："收藏" + "分享到社交媒体"（生成含卡牌图片 + 数据的分享卡片）

---

## 十五、历史副本页 (Dungeon History)

**页面目的：** 回顾已完成的所有剧本章节，支持重温精彩剧情。

**布局结构：**
```
┌──────────────────────────────┐
│  [←] 历史副本      [筛选]     │
├──────────────────────────────┤
│                              │
│  搜索栏                       │
│  ┌────────────────────────┐  │
│  │ 🔍 搜索章节名/关键词...  │  │
│  └────────────────────────┘  │
│                              │
│  ── 赛博夜之城 ──             │
│  ┌────────────────────────┐  │
│  │  📖 第 42 章 "霓虹审判"  │  │
│  │  2024.06.15  词汇: 5    │  │
│  │  选择: 智慧型  结果: 胜利 │  │
│  ├────────────────────────┤  │
│  │  📖 第 41 章 "数据洪流"  │  │
│  │  2024.06.14  词汇: 5    │  │
│  │  选择: 力量型  结果: 胜利 │  │
│  └────────────────────────┘  │
│                              │
│  ── 修仙飞升 ──               │
│  ┌────────────────────────┐  │
│  │  📖 第 3 章 "天道试炼"   │  │
│  │  2024.03.15  词汇: 5    │  │
│  └────────────────────────┘  │
│                              │
└──────────────────────────────┘
```

**关键元素：**
- 按世界观分组展示，每组可折叠
- 每条记录显示：章节名 + 日期 + 包含词汇数 + 选择路线 + 战斗结果
- 点击进入章节详情：显示完整英文剧情回顾（若原文片段已存储）或摘要重建
- 筛选支持：按世界观/按日期范围/按战斗结果
- **存储策略：** 保存章节元数据（标题/日期/词汇/选择/结果）+ 剧情摘要（200 字），完整剧情文本仅缓存最近 30 章

---

## 十六、词库管理页 (Word Pack Management)

**页面目的：** 管理已选词库，支持添加/移除词库，查看学习进度。

**布局结构：**
```
┌──────────────────────────────┐
│  [←] 词库管理                 │
├──────────────────────────────┤
│                              │
│  ── 当前学习中 ──             │
│  ┌────────────────────────┐  │
│  │  📘 CET-4              │  │
│  │  ━━━━━━━━░░ 1825/4500  │  │
│  │  殿堂: 575  高危: 25    │  │
│  ├────────────────────────┤  │
│  │  📘 CET-6              │  │
│  │  ━━░░░░░░░░ 420/5500   │  │
│  │  殿堂: 30   高危: 18    │  │
│  └────────────────────────┘  │
│                              │
│  ── 可添加词库 ──             │
│  [中小学] [大学/考研] [出国留学]│
│  ┌────────────────────────┐  │
│  │  📗 7年级     600词  [+]│  │
│  ├────────────────────────┤  │
│  │  📗 8年级     700词  [+]│  │
│  ├────────────────────────┤  │
│  │  📗 10年级    800词  [+]│  │
│  ├────────────────────────┤  │
│  │  📗 考研英语 5000词  [+]│  │
│  ├────────────────────────┤  │
│  │  📗 IELTS   3500词  [+]│  │
│  ├────────────────────────┤  │
│  │  ...更多词库             │  │
│  └────────────────────────┘  │
│                              │
│  每日新词数量  [滑块 20]       │
│                              │
└──────────────────────────────┘
```

**关键元素：**
- 当前学习中的词库：显示进度条 + 殿堂词数 + 今日高危词数
- 左滑可暂停/移除词库（二次确认，学习数据保留）
- 可添加词库区：点击 [+] 添加到学习队列
- 底部可调整每日新词数量（与设置页同步）
- 点击已学词库可查看详细词频分布和难度曲线

---

## 十七、详细统计页 (Detailed Statistics)

**页面目的：** 深度数据分析，展示长期学习趋势和能力画像。

**布局结构：**
```
┌──────────────────────────────┐
│  [←] 详细统计                 │
├──────────────────────────────┤
│                              │
│  时间范围选择器                │
│  [7天] [30天] [全部]          │
│                              │
│  ── 学习趋势 ──               │
│  ┌────────────────────────┐  │
│  │  📈 折线图               │  │
│  │  横轴: 日期              │  │
│  │  纵轴: 每日学习词数       │  │
│  │  双线: 新词 / 复习词      │  │
│  └────────────────────────┘  │
│                              │
│  ── 记忆效率 ──               │
│  ┌────────────────────────┐  │
│  │  📊 柱状图               │  │
│  │  各等级词汇数量分布       │  │
│  │  Lv.0 | Lv.1 | Lv.2 |  │  │
│  │  Lv.3 | Lv.4 | Lv.5    │  │
│  └────────────────────────┘  │
│                              │
│  ── 战斗能力 ──               │
│  ┌────────────────────────┐  │
│  │  平均反应时间: 0.82s     │  │
│  │  完美格挡率: 34%         │  │
│  │  正确率: 92%             │  │
│  │  最长连击: 23            │  │
│  └────────────────────────┘  │
│                              │
│  ── 预测 ──                  │
│  ┌────────────────────────┐  │
│  │  按当前速率，预计再学习    │  │
│  │  128 天完成全部词库       │  │
│  └────────────────────────┘  │
│                              │
└──────────────────────────────┘
```

**关键元素：**
- 时间范围切换器影响所有图表数据
- 学习趋势折线图：新词（蓝线）+ 复习词（橙线），可交互查看具体日期数据
- 等级分布柱状图：每个 Lv 使用对应颜色（灰/橙/红/蓝/白/金）
- 战斗能力面板：关键指标 + 与上一周期的对比箭头（↑/↓）
- 预测模块：基于近 7 天学习速率线性外推
- 所有图表使用 Swift Charts / 自定义绘制，支持触控交互

---

## 十八、排行榜页 (Leaderboard)

**页面目的：** 社交竞争激励，展示好友和全服排名。

**布局结构：**
```
┌──────────────────────────────┐
│  [←] 排行榜                   │
├──────────────────────────────┤
│                              │
│  分段控件                     │
│  [殿堂词数] [连续天数] [战力]  │
│                              │
│  ── 前三名 ──                │
│  ┌────────────────────────┐  │
│  │     🥇                  │  │
│  │  🥈    🥉               │  │
│  │ 用户A  用户B  用户C      │  │
│  │  892   756   701        │  │
│  └────────────────────────┘  │
│                              │
│  排名列表                     │
│  ┌────────────────────────┐  │
│  │ 4.  [头像] 用户D   658  │  │
│  ├────────────────────────┤  │
│  │ 5.  [头像] 用户E   612  │  │
│  ├────────────────────────┤  │
│  │ ...                    │  │
│  ├────────────────────────┤  │
│  │ 42. [头像] 我     575  │  │
│  │     (高亮当前用户)       │  │
│  └────────────────────────┘  │
│                              │
│  Tab: [好友榜] [全服榜]       │
│                              │
└──────────────────────────────┘
```

**关键元素：**
- 分段控件切换排名维度：殿堂词数 / 连续学习天数 / 总战力
- 前三名使用奖牌样式展示（放大头像 + 金银铜色）
- 当前用户行高亮（蓝色背景），无论排名多低都固定显示在可视区底部
- 好友榜 / 全服榜 Tab 切换
- 点击他人头像可查看简要公开资料（殿堂词数 / 连续天数 / 当前装备）
- 每周日 24:00 结算，周一刷新排名

---

## 页面流转图 (Navigation Flow)

```
                    ┌──────────┐
                    │ 欢迎引导  │
                    └────┬─────┘
                         │ (首次)
                    ┌────▼─────┐
                    │ 登录注册  │
                    └────┬─────┘
                         │ (首次)
                    ┌────▼─────┐
                    │ 词库选择  │
                    └────┬─────┘
                         │ (首次)
                    ┌────▼─────┐
                    │ 世界观设定 │
                    └────┬─────┘
                         │
        ┌────────────────▼────────────────┐
        │            主页 (Home)            │
        │   Tab Bar: 主页|真理之书|锻造|我的  │
        └───┬────────┬────────┬────────┬──┘
            │        │        │        │
     ┌──────▼──┐ ┌───▼───┐ ┌─▼────┐ ┌─▼──┐
     │消除红星  │ │ 星图   │ │灵魂  │ │个人│
     │(CTA)    │ │(Codex)│ │锻造  │ │中心│
     └────┬────┘ └───┬───┘ └──────┘ └─┬──┘
          │          │                 │
     ┌────▼────┐ ┌───▼────┐     ┌─────▼────┐
     │副本生成  │ │单词编年 │     │ 设置页    │
     │(Loading)│ │  史     │     │ 词库管理  │
     └────┬────┘ └────────┘     │ 成就系统  │
          │                     │ 荣誉殿堂  │
     ┌────▼────┐                │ 历史副本  │
     │剧本阅读  │                │ 详细统计  │
     │(Story)  │                │ 排行榜    │
     └────┬────┘                └──────────┘
          │ (战斗触发)
     ┌────▼────┐
     │闪击战斗  │
     │(Combat) │
     └────┬────┘
          │
     ┌────▼────┐
     │战斗结算  │
     │(Result) │
     └────┬────┘
          │
          └──────→ 返回主页 (星图动画更新)
```

---

## 全局异常态设计 (Error & Empty States)

### 网络异常

| 触发场景 | 显示内容 | 操作 |
|---------|---------|------|
| 副本生成失败（AIGC 超时） | 传送门动画卡住 → 切换为"信号干扰"特效 + "连接异常，正在重试..." | 自动重试 3 次，失败后显示"重试"按钮 + "离线战斗"入口 |
| 弱网 / 无网络 | 页面顶部出现红色横条："当前网络不可用" | 离线可用功能保持正常（生词本、编年史、星图浏览），AIGC 功能提示"需要网络连接" |
| 数据同步失败 | toast 提示"同步失败，稍后重试" | 本地数据优先，下次联网时增量同步 |

### 空状态

| 页面 | 空态场景 | 显示内容 |
|------|---------|---------|
| **主页** | 首次进入（无学习数据） | Hero Section 显示新角色 + "开启你的第一次冒险" CTA |
| **星图** | 无任何学习过的词 | 全屏迷雾效果 + 中心一颗微弱脉动的引导星 + "点击开始学习，点亮第一颗星" |
| **星图** | 高危词为 0 | 核心区显示"✨ 今日无红星，去探索新词？" + "学习新词"按钮 |
| **星图** | 全部词汇 Lv.5 | 全屏金色星河 + "恭喜！你已掌握全部词汇" 庆祝动画 |
| **生词本** | 无标记词汇 | 插画 + "阅读剧情时点击生词即可添加" |
| **历史副本** | 无完成副本 | 插画 + "完成你的第一次冒险，这里会记录你的故事" |
| **荣誉殿堂** | 无殿堂词 | 里程碑卡牌全部锁定状态 + "将第一个词送入殿堂，解锁首张卡牌" |
| **灵魂锻造** | 无装备 | 角色穿着初始布衣 + "完成战斗获取装备和灵魂碎片" |

### AIGC 降级策略

当 LLM 生成失败或质量低于阈值时：
1. **自动重试一次**（使用不同 temperature 参数）
2. **Fallback 到预制模板库**：系统内置 50+ 预制英文剧情模板，按世界观分类，动态替换目标词汇填入模板
3. **纯战斗模式**：跳过剧情，直接进入战斗（用户可在设置中开启"离线战斗模式"预缓存 3 波纯战斗副本）

---

## 新手引导设计 (Onboarding Tutorials)

### 引导策略

采用**渐进式引导**，不在首次使用时一次性展示所有功能，而是在用户首次到达对应页面时触发。

### 引导时机与内容

| 触发时机 | 引导形式 | 内容 |
|---------|---------|------|
| **首次进入主页** | 聚焦蒙版 (Coach Mark) 3 步 | ① 高亮 CTA 按钮："点这里开始学习" → ② 高亮今日概览："这里显示今天的任务" → ③ 高亮快捷入口："随时查看星图和生词本" |
| **首次进入星图** | 聚焦蒙版 2 步 + 手势提示 | ① 高亮核心区红星："红色的星是你需要复习的词" → ② 手势动画（双指缩放/单指拖动）："缩放和拖动探索更多" |
| **首次进入战斗-格挡** | 全屏教学关卡（减速 + 提示） | 第一次格挡使用 3 秒倒计时（非 1 秒），箭头指向正确答案，提示"看到英文单词，点击对应的中文" |
| **首次进入战斗-吟唱** | 全屏教学关卡 | 同上，减速 + 箭头提示，"看到中文，点击对应的英文气泡" |
| **首次进入战斗-决斗** | 提前弹窗预告 | "⚡ 即将进入决斗！你需要在 1 秒内做出选择" → 第一次决斗使用 2 秒倒计时 |
| **首次进入灵魂锻造** | 聚焦蒙版 2 步 | ① 高亮装备槽："点击装备槽管理你的装备" → ② 高亮战力面板："ATK 影响判定时间，DEF 减少受伤" |

### 引导视觉规范

- **蒙版颜色：** 黑色 70% opacity，高亮区域镂空 + 发光边框
- **提示气泡：** 白色圆角卡片，箭头指向目标，文案简短（不超过 15 字）
- **"跳过引导" 按钮：** 始终可见在右上角，点击后当前页面引导全部跳过
- **不再显示：** 引导完成或跳过后，标记为已完成，不再触发

---

## 设计审查备注

### 需要重点关注的风险项

1. **AIGC 内容质量一致性**：LLM 生成的剧本质量波动较大，需要建立内容审核 pipeline 和 fallback 模板机制。当生成质量低于阈值时，使用预制模板替换。

2. **首屏加载性能**：主页角色立绘 + 星图渲染 + 数据拉取，冷启动可能超过 3 秒。建议：骨架屏 + 本地缓存 + 增量数据同步。

3. **星图同心环布局的边界情况**：当高危词为 0 时，核心区为空——需要设计空态（如"今日无红星，去探索新词？"引导）。当高危词超过 50 时，核心区可能过于拥挤——需要动态调整核心区半径或分层堆叠。

4. **战斗模式的无障碍性**：当前战斗机制高度依赖反应速度，对视力/运动能力受限的用户不友好。建议提供"无障碍模式"，将时间限制放宽或改为非时间敏感的交互方式。

5. **离线体验**：AIGC 依赖网络，用户在地铁等弱网环境下无法使用核心功能。建议预缓存 2-3 波备用副本，或提供纯战斗模式(无剧本)的离线体验。

6. **分波节奏把控**：每波 5 词 = 1段剧情 + 1场战斗 + 1次结算，单波时长控制在 3-5 分钟。结算页"下一波"按钮是留存关键入口，需要足够醒目且减少操作步骤。

7. **装备数值平衡**：ATK/DEF 对战斗的影响需要精细调参。ATK 加成的判定时间宽裕度不能太大（否则高装备用户失去紧张感），也不能太小（否则升级无感）。建议设置上限（如 ATK 加成最多 +0.3s），并通过敌人成长机制动态抵消部分加成，保持战斗张力。

8. **敌人成长曲线**：敌人等级与用户装备等级的 gap 需要控制。如果用户只学习不升级装备，敌人会逐渐碾压——这是刻意的设计（倒逼用户消费碎片升级），但 gap 过大会导致挫败感。建议当 gap ≥ 3 级时触发"紧急锻造引导"弹窗。

### 已确认的设计决策

| 决策项 | 确认值 | 理由 |
|--------|--------|------|
| 决斗判定时间 | **1.0 秒** | 扣除触控延迟和认知处理后，有效决策窗口约 500-600ms |
| 每波红星数量 | **5 个** | 单波 3-5 分钟，适配碎片化场景 |
| 星图初始视野 | **核心区（Lv.2 高危词）** | 用户第一眼看到最紧迫的内容，Lv.1 烙印词在核心区外围 |
| 已完成词位置 | **视野外围（需平移）** | 减少视觉噪音，聚焦当前任务 |
| Lv.0 迷雾词 | **不渲染为独立光点，用边缘雾气暗示** | 避免数千灰点干扰视野 |
| Lv.1 vs Lv.2 | **独立样式：Lv.1 橙黄暖光 / Lv.2 红色脉动** | Lv.1 是 Day 0 新学词，尚未高危；Lv.2 是 Day 1 遗忘临界点 |
| 主题 | **浅色主题** | 星图和战斗页使用深色画布（功能性例外） |
| 剧情语言 | **正文全英文，UI 中文** | 沉浸式英文阅读接触目标词汇 |
| 装备核心属性 | **ATK（攻击力）+ DEF（防御力）** | ATK 影响判定时间宽裕度，DEF 影响受伤减免 |
| 判定时间上限 | **最大 1.5s（格挡/吟唱），1.3s（决斗）** | ATK 与难度不叠乘，防止判定窗口失控 |
| 装备槽位 | **V1: 3 个（武器/护甲/饰品）** | 精简 MVP，验证后再扩展 |
| 敌人升级节奏 | **每 10 波升 1 级** | 匹配碎片获取速率，用户有足够资源升级装备 |
| 装备品质体系 | **灰/绿/蓝/紫/金 五级** | 品质影响属性成长系数（x1.0 ~ x3.0） |
| 渲染方案 | **分层合成 + SpriteKit/Skia，V1 单世界观美术** | 控制资产量，跨平台兼容 |
| 角色展示区 | **28% 屏高 + 滚动 collapse** | 确保 CTA 和任务概览首屏可见 |
| 里程碑卡牌 | **10 张（关键殿堂词阈值触发）** | 保持稀缺感和仪式感 |
